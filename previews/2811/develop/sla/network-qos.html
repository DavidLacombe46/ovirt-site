<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Network QoS | oVirt</title>
<meta name="generator" content="Jekyll v3.9.1" />
<meta property="og:title" content="Network QoS" />
<meta name="author" content="Dan Kenigsberg" />
<meta property="og:locale" content="en" />
<meta name="description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<meta property="og:description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<link rel="canonical" href="https://ovirt.github.io/ovirt-site/previews/2811/develop/sla/network-qos.html" />
<meta property="og:url" content="https://ovirt.github.io/ovirt-site/previews/2811/develop/sla/network-qos.html" />
<meta property="og:site_name" content="oVirt" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Network QoS" />
<meta name="twitter:site" content="@ovirt" />
<meta name="twitter:creator" content="@Dan Kenigsberg" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Dan Kenigsberg"},"description":"oVirt is a free open-source virtualization solution for your entire enterprise","@type":"WebPage","headline":"Network QoS","url":"https://ovirt.github.io/ovirt-site/previews/2811/develop/sla/network-qos.html","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ovirt.github.io/ovirt-site/previews/2811/images/logo.svg"},"name":"Dan Kenigsberg"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
  <link rel="stylesheet" href="/ovirt-site/previews/2811/stylesheets/fonts.css" />
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
  <link rel="stylesheet" href="/ovirt-site/previews/2811/stylesheets/application.css" />
  <link rel="stylesheet" href="/ovirt-site/previews/2811/stylesheets/print.css" media="print" />
  <link rel="stylesheet" href="/ovirt-site/previews/2811/stylesheets/coderay.css" media="screen" />
  <link rel="stylesheet" href="/ovirt-site/previews/2811/stylesheets/asciidoc.css" />
  <script src="/ovirt-site/previews/2811/javascripts/vendor/jquery.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2811/javascripts/vendor/bootstrap.min.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2811/javascripts/vendor/bootstrap-sortable.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2811/javascripts/vendor/moment.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2811/javascripts/vendor/fullcalendar/fullcalendar.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2811/javascripts/lib/cal-widget.js" type="text/javascript"></script>
  <!-- Begin Jekyll Favicon tag v0.2.9 -->
<!-- Classic -->
<link rel="shortcut icon" href="/ovirt-site/previews/2811/favicon.ico">
<link rel="icon" sizes="48x48 32x32 16x16" href="/ovirt-site/previews/2811/favicon.ico">
  <link rel="icon" sizes="16x16" type="image/png" href="/ovirt-site/previews/2811/images/favicon-16x16.png">
  <link rel="icon" sizes="32x32" type="image/png" href="/ovirt-site/previews/2811/images/favicon-32x32.png">
  <link rel="icon" sizes="64x64" type="image/png" href="/ovirt-site/previews/2811/images/favicon-64x64.png">
  <link rel="icon" sizes="144x144" type="image/png" href="/ovirt-site/previews/2811/images/favicon-144x144.png">
<!-- Safari -->
  <link rel="apple-touch-icon" sizes="57x57" href="/ovirt-site/previews/2811/images/favicon-57x57.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/ovirt-site/previews/2811/images/favicon-76x76.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/ovirt-site/previews/2811/images/favicon-120x120.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/ovirt-site/previews/2811/images/favicon-152x152.png">
  <link rel="apple-touch-icon" sizes="167x167" href="/ovirt-site/previews/2811/images/favicon-167x167.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/ovirt-site/previews/2811/images/favicon-180x180.png">
<!-- Chrome -->
  <link rel="icon" sizes="192x192" href="/ovirt-site/previews/2811/images/favicon-192x192.png">
  <link rel="icon" sizes="96x96" href="/ovirt-site/previews/2811/images/favicon-96x96.png">
  <link rel="icon" sizes="48x48" href="/ovirt-site/previews/2811/images/favicon-48x48.png">
<link rel="manifest" href="/ovirt-site/previews/2811/manifest.webmanifest">
<!-- IE -->
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ovirt-site/previews/2811/images/favicon-144x144.png">
<meta name='msapplication-config' content="/ovirt-site/previews/2811/browserconfig.xml">
<!-- End Jekyll Favicon tag -->
</head>
<body class=""><header class='masthead hidden-print' id='branding' role='banner'><section class='hgroup'></section><div id='access'><nav id="mainNav" class="navbar navbar-fixed-top affix-top">  <div class="container">    <div class="col-sm-2 navbar-header">      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#menu_id0980fddf">        <span class="sr-only">Toggle navigation</span>        <span>Menu</span>        <span class="fa fa-bars"></span>      </button>      <a class="navbar-brand" href="/ovirt-site/previews/2811/">        <img id="logo" alt="oVirt" src="/ovirt-site/previews/2811/images/logo.svg">      </a>    </div>    <!-- Collect the nav links, forms, and other content for toggling -->    <div class="col-sm-10">      <div class="navbar-collapse collapse" id="menu_id0980fddf">        <ul class="nav navbar-nav">          <li class="hidden active">            <a href="#page-wrap"></a>          </li><li role='menuitem'>  <a href='/ovirt-site/previews/2811/download/'>Download</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2811/documentation/'>Documentation</a></li><li class='active' role='menuitem'>  <a href='/ovirt-site/previews/2811/develop/'>Developers</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2811/community/'>Community</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2811//lists.ovirt.org/archives/'>Forum</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2811//blogs.ovirt.org/'>Blog</a></li>              </ul>          </div>          <!-- /.navbar-collapse -->      </div>      <!-- /.container-fluid -->    </div>  </div></nav></div></header><main id="page-wrap" class="page-wrap" aria-label="Content">
      <section id="page" class="page">
        <!-- adapted from https://github.com/git-no/jekyll-breadcrumbs -->
<nav class="breadcrumbs bootstrap hidden-sm-down" aria-label="breadcrumb">

   <ol class="breadcrumb list-unstyled" vocab="http://schema.org/" typeof="BreadcrumbList">

      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2811/">
              <span property="name"></span>
              <meta property="position" content="1" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2811/develop/">
              <span property="name">Developers Community</span>
              <meta property="position" content="2" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2811/develop/sla/">
              <span property="name">Sla</span>
              <meta property="position" content="3" />
           </a>
        </li>
      
        
        
          

   </ol>

</nav>

        
          
            <header class="post-header col-md-4 pad-sides well well-lg">
              <h2 class="post-title entry-title">Authors:</h2>
              <header class="post-meta">
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/ce421080e5d2da87febb626f6e8906c9?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/ce421080e5d2da87febb626f6e8906c9?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy">
                  </div>
                  <span class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Dan Kenigsberg</span></p>
                      
                    </section>
                  </span>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/90758110b19ee0a2e03473012fdc1bd7?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/90758110b19ee0a2e03473012fdc1bd7?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy">
                  </div>
                  <span class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Moti Asayag</span></p>
                      
                    </section>
                  </span>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/819d7e00c07db9447fa5705dadfe8c02?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/819d7e00c07db9447fa5705dadfe8c02?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy">
                  </div>
                  <span class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Ofri Masad</span></p>
                      
                    </section>
                  </span>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/92517631861d6438bbc8b312cf9ef0a7?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/92517631861d6438bbc8b312cf9ef0a7?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy">
                  </div>
                  <span class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Oved Ourfali</span></p>
                      
                    </section>
                  </span>
                
              </header>
            </header>
          
        
        <section id="content" class="content container">
          <div class='alert alert-warning'>This developer documentation is <strong>outdated</strong>, but provides historical context.<br><br>It is <strong>not</strong> user documentation and should not be treated as such.<br><br><a href='/ovirt-site/previews/2811/documentation/'>Documentation is available here.</a></div>

<h1 id="network-qos">Network QoS</h1>

<h4 id="summary">Summary</h4>

<p>Network Quality of Service feature will be added to oVirt from version 3.3 and will support cluster version 3.3 or higher.
The feature will allow the user to limit the inbound and outbound network traffic in virtual NIC level.
In order to define more natural coupling of the QoS to a VNIC we define a new concept called <strong><a href="/ovirt-site/previews/2811/develop/release-management/features/sla/vnic-profiles.html">VNIC Profile</a></strong>. The VNIC profile will be introduced in oVirt 3.3 to all clusters and will wrap few of the properties currently defined directly on the VNIC</p>

<h4 id="owner">Owner</h4>

<ul>
  <li>Name: Ofri Masad</li>
  <li>Email: <omasad at="" redhat="" dot="" com=""></omasad></li>
</ul>

<h4 id="current-status">Current status</h4>

<ul>
  <li>Status: Network QoS done.</li>
  <li>Last updated: ,</li>
</ul>

<h4 id="detailed-description">Detailed Description</h4>

<p>Traffic shaping is a very common practice in network management. Traffic shaping allows the network administrator to prevent over consumption of network resources by limiting the bandwidth in several layers. Current implementation of libvirt allows limiting the bandwidth in the virtual NIC level for both inbound and outbound traffic. The Network QoS on oVirt make use of that API and allows the network administrator to define network limitations on specific VNICs.</p>

<p>The QoS properties are properties which defines the traffic shaping applied on the virtual NIC . QoS properties currently include:</p>

<ul>
  <li>Inbound
    <ul>
      <li>Average - long-term limit around which traffic should float (Mbps)</li>
      <li>Peak - the maximum allowed bandwidth during burst (Mbps)</li>
      <li>Burst - The burst size (Mb)</li>
    </ul>
  </li>
  <li>Outbound
    <ul>
      <li>Average - long-term limit around which traffic should float (Mbps)</li>
      <li>Peak - the maximum allowed bandwidth during burst (Mbps)</li>
      <li>Burst - The burst size (Mb)</li>
    </ul>
  </li>
</ul>

<p>For example: if average is set to 100 units, peak to 200 and burst to 50, after sending those 50 units of data at rate 200, the rate will fall down to 100.</p>

<p>Traffic shaping using the Network QoS feature will be available only for oVirt networks at this stage. Externally provided networks (such as Quantum) may be supported in future extensions.</p>

<h4 id="benefit-to-ovirt">Benefit to oVirt</h4>

<p>We would like to expose to the user the ability to configure the Network Quality of Service (QoS) properties of each virtual NIC. The Network QoS feature will add this ability to the engine.</p>

<h2 id="design-and-implementation">Design and Implementation</h2>

<p>see : <a href="/ovirt-site/previews/2811/develop/release-management/features/network/network-qos-detailed-design.html">Network QoS - detailed design Implementation details</a> for detailed design</p>

<h4 id="gui">GUI</h4>

<p>The UI for setting of QoS properties will be added to the Add/Edit Profile dialog.
 <strong>Network QoS sub tab</strong>
<img src="/ovirt-site/previews/2811/images/wiki/Qos_new_tab.png" alt="" /></p>

<p>The Network QoS will be added as sub tab of Data Center (administrator port6al only) . The administrator will be able to Add/Remove/Edit Network QoS entities. The QoS name and all 6 properties will be viewed in the table.</p>

<p><strong>Add/Edit Network QoS dialog</strong>
<img src="/ovirt-site/previews/2811/images/wiki/Qos_neq_dialog.png" alt="" /></p>

<p>The Add/Edit Network QoS dialog will include text field for name and six text fields for the values.
The administrator could enable/disable the QoS properties (for each inbound / outbound). Disabled QoS will mean no limitation on the traffic in this direction
Once inbound/outbound was enabled all three field must be filled (This will be verified before allowing to close the dialog). The Peak and Burst fields will be automatically filled when entering Average value (and could be edited manually).</p>

<h4 id="backend">Backend</h4>

<p>We define a new entity called “NetworkQoS” - the QoS properties will be contained in this object.
A NetworkQoS object will be added to NetworkProfile entity.
see : <a href="/ovirt-site/previews/2811/develop/release-management/features/network/network-qos-detailed-design.html">Network QoS - detailed design Implementation details</a> for detailed design</p>

<h4 id="db-change">DB Change</h4>

<p>Add network_qos table.
see : <a href="/ovirt-site/previews/2811/develop/release-management/features/network/network-qos-detailed-design.html">Network QoS - detailed design Implementation details</a> for detailed design</p>

<h4 id="rest-api">REST API</h4>

<p>Not supported in this version</p>

<h4 id="vdsm">VDSM</h4>

<p>libvirt version 1.0.1 or higher is required to enable the QoS feature (vdsm 3.3 will use higher version).</p>

<ul>
  <li>Add support of QoS properties in VDSM API: run VM, hot plug and update VM device verbs (update in schema)</li>
  <li>Add support in the vnic object and the vnic to_xml()</li>
</ul>

<p>see : <a href="/ovirt-site/previews/2811/develop/release-management/features/network/network-qos-detailed-design.html">Network QoS - detailed design Implementation details</a> for detailed design</p>

<h3 id="tests">Tests</h3>

<h4 id="expected-unit-tests">Expected unit-tests</h4>

<ul>
  <li>Unit test for Dao - Unit test for Commands (add/update/remove) - Unit test for query</li>
</ul>

<h3 id="special-considerations">Special considerations</h3>

<h3 id="dependencies--related-features">Dependencies / Related Features</h3>

<ul>
  <li>Dependent on the feature <a href="/ovirt-site/previews/2811/develop/release-management/features/sla/vnic-profiles.html">Vnic Profiles</a></li>
</ul>

<p>Affected ovirt projects:</p>

<ul>
  <li>API</li>
  <li>backend</li>
  <li>Webadmin</li>
  <li>User Portal</li>
</ul>

<p>Others projects:</p>

<ul>
  <li>vdsm</li>
</ul>

<h3 id="documentation--external-references">Documentation / External references</h3>

<ul>
  <li>See: <a href="http://libvirt.org/formatdomain.html#elementQoS">http://libvirt.org/formatdomain.html#elementQoS</a> for documentation of the VM level network QoS XML.</li>
</ul>




        </section>
      </section>
    </main>

    <script src="/ovirt-site/previews/2811/javascripts/lib/headings_anchors.js" type="text/javascript"></script><footer class='text-center' id='footer'><hr class='visible-print'><ul class='footer-nav-list'><li><a href='/ovirt-site/previews/2811/privacy-policy.html' target='_blank' title='Privacy policy'>Privacy policy</a></li><li><a href='/ovirt-site/previews/2811/community/about.html' target='_blank' title='About'>About</a></li><li><a href='/ovirt-site/previews/2811/general-disclaimer.html' target='_blank' title='Disclaimers'>Disclaimers</a></li></ul>&copy; 2013&ndash;2022 oVirt<div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/issues/new?labels=content&amp;title=Issue:%20/develop/sla/network-qos.html&amp;template=' target='_blank' title='Report an issue'><i class="icon fab fa-github"></i>Report an issue with this page</a></div><div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/edit/master/source/develop/sla/network-qos.md' target='_blank' title='Edit this page'><i class="icon fab fa-github"></i>Edit this page</a></div></footer></body>

</html>
