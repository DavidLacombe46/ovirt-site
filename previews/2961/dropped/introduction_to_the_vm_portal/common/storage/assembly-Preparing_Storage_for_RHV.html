<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Preparing Storage for {virt-product-fullname} | oVirt</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="Preparing Storage for {virt-product-fullname}" />
<meta property="og:locale" content="en" />
<meta name="description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<meta property="og:description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<link rel="canonical" href="https://ovirt.github.io/ovirt-site/previews/2961/dropped/introduction_to_the_vm_portal/common/storage/assembly-Preparing_Storage_for_RHV.html" />
<meta property="og:url" content="https://ovirt.github.io/ovirt-site/previews/2961/dropped/introduction_to_the_vm_portal/common/storage/assembly-Preparing_Storage_for_RHV.html" />
<meta property="og:site_name" content="oVirt" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Preparing Storage for {virt-product-fullname}" />
<meta name="twitter:site" content="@ovirt" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"oVirt is a free open-source virtualization solution for your entire enterprise","headline":"Preparing Storage for {virt-product-fullname}","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ovirt.github.io/ovirt-site/previews/2961/images/logo.svg"}},"url":"https://ovirt.github.io/ovirt-site/previews/2961/dropped/introduction_to_the_vm_portal/common/storage/assembly-Preparing_Storage_for_RHV.html"}</script>
<!-- End Jekyll SEO tag -->

  <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
  <link rel="stylesheet" href="/ovirt-site/previews/2961/stylesheets/fonts.css" />
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
  <link rel="stylesheet" href="/ovirt-site/previews/2961/stylesheets/application.css" />
  <link rel="stylesheet" href="/ovirt-site/previews/2961/stylesheets/print.css" media="print" />
  <link rel="stylesheet" href="/ovirt-site/previews/2961/stylesheets/coderay.css" media="screen" />
  <link rel="stylesheet" href="/ovirt-site/previews/2961/stylesheets/asciidoc.css" />
  <script src="/ovirt-site/previews/2961/javascripts/vendor/jquery.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2961/javascripts/vendor/bootstrap.min.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2961/javascripts/vendor/bootstrap-sortable.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2961/javascripts/vendor/moment.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2961/javascripts/vendor/fullcalendar/fullcalendar.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2961/javascripts/lib/cal-widget.js" type="text/javascript"></script>
  <link href='/ovirt-site/previews/2961/favicon.ico' rel='shortcut icon' sizes='36x36 24x24 16x16' type='image/x-icon'/>
<link href='/ovirt-site/previews/2961/favicon.png' rel='icon' sizes='196x196' type='image/png'/>
<meta content='/ovirt-site/previews/2961/mstile-icon-128x128.png' name='msapplication-TileImage'/>
<meta content='transparent' name='msapplication-TileColor'/>
<link href='/ovirt-site/previews/2961/manifest.webmanifest' rel='manifest'/>
<meta content='/ovirt-site/previews/2961/browserconfig.xml' name='msapplication-config'/>
</head>
<body class=""><header class='masthead hidden-print' id='branding' role='banner'><section class='hgroup'></section><div id='access'><nav id="mainNav" class="navbar navbar-fixed-top affix-top">  <div class="container">    <div class="col-sm-2 navbar-header">      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#menu_id0980fddf">        <span class="sr-only">Toggle navigation</span>        <span>Menu</span>        <span class="fa fa-bars"></span>      </button>      <a class="navbar-brand" href="/ovirt-site/previews/2961/">        <img id="logo" alt="oVirt" src="/ovirt-site/previews/2961/images/logo.svg">      </a>    </div>    <!-- Collect the nav links, forms, and other content for toggling -->    <div class="col-sm-10">      <div class="navbar-collapse collapse" id="menu_id0980fddf">        <ul class="nav navbar-nav">          <li class="hidden active">            <a href="#page-wrap"></a>          </li><li role='menuitem'>  <a href='/ovirt-site/previews/2961/download/'>Download</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2961/documentation/'>Documentation</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2961/develop/'>Developers</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2961/community/'>Community</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2961//lists.ovirt.org/archives/'>Forum</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2961//blogs.ovirt.org/'>Blog</a></li>              </ul>          </div>          <!-- /.navbar-collapse -->      </div>      <!-- /.container-fluid -->    </div>  </div></nav></div></header><main id="page-wrap" class="page-wrap" aria-label="Content">
      <section id="page" class="page">
        <!-- adapted from https://github.com/git-no/jekyll-breadcrumbs -->
<nav class="breadcrumbs bootstrap hidden-sm-down" aria-label="breadcrumb">

   <ol class="breadcrumb list-unstyled" vocab="http://schema.org/" typeof="BreadcrumbList">

      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2961/">
              <span property="name"></span>
              <meta property="position" content="1" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2961/dropped/">
              <span property="name">Dropped</span>
              <meta property="position" content="2" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2961/dropped/introduction_to_the_vm_portal/">
              <span property="name">Introduction to the VM Portal</span>
              <meta property="position" content="3" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2961/dropped/introduction_to_the_vm_portal/common/">
              <span property="name">Common</span>
              <meta property="position" content="4" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2961/dropped/introduction_to_the_vm_portal/common/storage/">
              <span property="name">Storage</span>
              <meta property="position" content="5" />
           </a>
        </li>
      
        
        
          

   </ol>

</nav>

        
          
        
        <section id="content" class="content container">
          
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>You need to prepare storage to be used for storage domains in the new environment. A {virt-product-fullname} environment must have at least one data storage domain, but adding more is recommended.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When installing or reinstalling the host&#8217;s operating system, {org-fullname} strongly recommends that you first detach any existing non-OS storage that is attached to the host to avoid accidental initialization of these disks, and with that, potential data loss.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A data domain holds the virtual hard disks and OVF files of all the virtual machines and templates in a data center, and cannot be shared across data centers while active (but can be migrated between data centers). Data domains of multiple storage types can be added to the same data center, provided they are all shared, rather than local, domains.</p>
</div>
<div class="paragraph">
<p>You can use one of the following storage types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#Preparing_NFS_Storage_{context}">NFS</a></p>
</li>
<li>
<p><a href="#Preparing_iSCSI_Storage_{context}">iSCSI</a></p>
</li>
<li>
<p><a href="#Preparing_FCP_Storage_{context}">Fibre Channel (FCP)</a></p>
</li>
<li>
<p><a href="#Preparing_Red_Hat_Gluster_Storage_{context}">{gluster-storage-fullname}</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Preparing_NFS_Storage_{context}">Preparing NFS Storage</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Set up NFS shares on your file storage or remote server to serve as storage domains on Red Hat Enterprise Virtualization Host systems. After exporting the shares on the remote storage and configuring them in the Red Hat Virtualization Manager, the shares will be automatically imported on the Red Hat Virtualization hosts.</p>
</div>
<div class="paragraph">
<p>For information on setting up, configuring, mounting and exporting NFS, see <a href="{URL_rhel_docs_latest}html-single/managing_file_systems/index"><em>Managing file systems</em></a> for Red Hat Enterprise Linux 8.</p>
</div>
<div class="paragraph">
<p>Specific system user accounts and system user groups are required by {virt-product-fullname} so the {engine-name} can store data in the storage domains represented by the exported directories. The following procedure sets the permissions for one directory. You must repeat the <code>chown</code> and <code>chmod</code> steps for all of the directories you intend to use as storage domains in {virt-product-fullname}.</p>
</div>
<div class="olist arabic">
<div class="title">Prerequisites</div>
<ol class="arabic">
<li>
<p>Install the NFS <code>utils</code> package.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="terminal"># dnf install nfs-utils -y</code></pre>
</div>
</div>
</li>
<li>
<p>To check the enabled versions:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="terminal"># cat /proc/fs/nfsd/versions</code></pre>
</div>
</div>
</li>
<li>
<p>Enable the following services:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="terminal"># systemctl enable nfs-server
# systemctl enable rpcbind</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create the group <code>kvm</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="terminal"># groupadd kvm -g 36</code></pre>
</div>
</div>
</li>
<li>
<p>Create the user <code>vdsm</code> in the group <code>kvm</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="terminal"># useradd vdsm -u 36 -g kvm</code></pre>
</div>
</div>
</li>
<li>
<p>Create the <code>storage</code> directory and modify the access rights.</p>
<div class="listingblock">
<div class="content">
<pre># mkdir /storage
# chmod 0755 /storage
# chown 36:36 /storage/</pre>
</div>
</div>
</li>
<li>
<p>Add the <code>storage</code> directory to <code>/etc/exports</code> with the relevant permissions.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="terminal"># vi /etc/exports
# cat /etc/exports
 /storage *(rw)</code></pre>
</div>
</div>
</li>
<li>
<p>Restart the following services:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="terminal"># systemctl restart rpcbind
# systemctl restart nfs-server</code></pre>
</div>
</div>
</li>
<li>
<p>To see which export are available for a specific IP address:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="terminal"># exportfs
 /nfs_server/srv
               10.46.11.3/24
 /nfs_server       &lt;world&gt;</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If changes in <code>/etc/exports</code> have been made after starting the services, the <code class="command">exportfs -ra</code> command can be used to reload the changes.
After performing all the above stages, the exports directory should be ready and can be tested on a different host to check that it is usable.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Preparing_iSCSI_Storage_{context}">Preparing iSCSI Storage</h2>
<div class="sectionbody">
<div class="paragraph">
<p>{virt-product-fullname} supports iSCSI storage, which is a storage domain created from a volume group made up of LUNs. Volume groups and LUNs cannot be attached to more than one storage domain at a time.</p>
</div>
<div class="paragraph">
<p>For information on setting up and configuring iSCSI storage, see <a href="{URL_rhel_docs_latest}html-single/managing_storage_devices/index#getting-started-with-iscsi_managing-storage-devices">Getting started with iSCSI</a> in <em>Managing storage devices</em> for Red Hat Enterprise Linux 8.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you are using block storage and intend to deploy virtual machines on raw devices or direct LUNs and manage them with the Logical Volume Manager (LVM), you must create a filter to hide guest logical volumes. This will prevent guest logical volumes from being activated when the host is booted, a situation that could lead to stale logical volumes and cause data corruption. Use the <code>vdsm-tool config-lvm-filter</code> command to create filters for the LVM.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>{virt-product-fullname} currently does not support block storage with a block size of 4K. You must configure block storage in legacy (512b block) mode.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If your host is booting from SAN storage and loses connectivity to the storage, the storage file systems become read-only and remain in this state after connectivity is restored.</p>
</div>
<div class="paragraph">
<p>To prevent this situation, add a drop-in multipath configuration file on the root file system of the SAN for the boot LUN to ensure that it is queued when there is a connection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="terminal"># cat /etc/multipath/conf.d/host.conf
multipaths {
    multipath {
        wwid <em>boot_LUN_wwid</em>
        no_path_retry queue
    }</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Preparing_FCP_Storage_{context}">Preparing FCP Storage</h2>
<div class="sectionbody">
<div class="paragraph">
<p>{virt-product-fullname} supports SAN storage by creating a storage domain from a volume group made of pre-existing LUNs. Neither volume groups nor LUNs can be attached to more than one storage domain at a time.</p>
</div>
<div class="paragraph">
<p>{virt-product-fullname} system administrators need a working knowledge of Storage Area Networks (SAN) concepts. SAN usually uses Fibre Channel Protocol (FCP) for traffic between hosts and shared external storage. For this reason, SAN may occasionally be referred to as FCP storage.</p>
</div>
<div class="paragraph">
<p>For information on setting up and configuring FCP or multipathing on {enterprise-linux}, see the <a href="{URL_rhel_docs_legacy}html/Storage_Administration_Guide/index.html"><em>Storage Administration Guide</em></a> and <a href="{URL_rhel_docs_legacy}html/DM_Multipath/index.html"><em>DM Multipath Guide</em></a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you are using block storage and intend to deploy virtual machines on raw devices or direct LUNs and manage them with the Logical Volume Manager (LVM), you must create a filter to hide guest logical volumes. This will prevent guest logical volumes from being activated when the host is booted, a situation that could lead to stale logical volumes and cause data corruption. Use the <code>vdsm-tool config-lvm-filter</code> command to create filters for the LVM.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>{virt-product-fullname} currently does not support block storage with a block size of 4K. You must configure block storage in legacy (512b block) mode.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If your host is booting from SAN storage and loses connectivity to the storage, the storage file systems become read-only and remain in this state after connectivity is restored.</p>
</div>
<div class="paragraph">
<p>To prevent this situation, add a drop-in multipath configuration file on the root file system of the SAN for the boot LUN to ensure that it is queued when there is a connection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="terminal"># cat /etc/multipath/conf.d/host.conf
multipaths {
    multipath {
        wwid <em>boot_LUN_wwid</em>
        no_path_retry queue
    }</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Preparing_Red_Hat_Gluster_Storage_{context}">Preparing {gluster-storage-fullname}</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="proc-Customizing_Multipath_Configurations_for_SAN_Vendors_{context}">Customizing Multipath Configurations for SAN Vendors</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If your RHV environment is configured to use multipath connections with SANs, you can customize the multipath configuration settings to meet requirements specified by your storage vendor. These customizations can override both the default settings and settings that are specified in <code>/etc/multipath.conf</code>.</p>
</div>
<div class="paragraph">
<p>To override the multipath settings, do not customize <code>/etc/multipath.conf</code>. Because VDSM owns <code>/etc/multipath.conf</code>, installing or upgrading VDSM or {virt-product-fullname} can overwrite this file including any customizations it contains. This overwriting can cause severe storage failures.</p>
</div>
<div class="paragraph">
<p>Instead, you create a file in the <code>/etc/multipath/conf.d</code> directory that contains the settings you want to customize or override.</p>
</div>
<div class="paragraph">
<p>VDSM executes the files in <code>/etc/multipath/conf.d</code> in alphabetical order. So, to control the order of execution, you begin the filename with a number that makes it come last. For example, <code>/etc/multipath/conf.d/90-myfile.conf</code>.</p>
</div>
<div class="paragraph">
<p>To avoid causing severe storage failures, follow these guidelines:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Do not modify <code>/etc/multipath.conf</code>. If the file contains user modifications, and the file is overwritten, it can cause unexpected storage problems.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Not following these guidelines can cause catastrophic storage errors.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>VDSM is configured to use the multipath module. To verify this, enter:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code># vdsm-tool is-configured --module multipath</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create a new configuration file in the <code>/etc/multipath/conf.d</code> directory.</p>
</li>
<li>
<p>Copy the individual setting you want to override from <code>/etc/multipath.conf</code> to the new configuration file in <code>/etc/multipath/conf.d/&lt;my_device&gt;.conf</code>. Remove any comment marks, edit the setting values, and save your changes.</p>
</li>
<li>
<p>Apply the new configuration settings by entering:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code># systemctl reload multipathd</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Do not restart the multipathd service. Doing so generates errors in the VDSM logs.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Verification steps</div>
<ol class="arabic">
<li>
<p>Test that the new configuration performs as expected on a non-production cluster in a variety of failure scenarios. For example, disable all of the storage connections.</p>
</li>
<li>
<p>Enable one connection at a time and verify that doing so makes the storage domain reachable.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="{URL_virt_product_docs}{URL_format}installing_{URL_product_virt}_as_a_self-hosted_engine_using_the_command_line/index#ref-Recommended_Settings_for_Multipath_conf_SHE_cli_deploy">Recommended Settings for Multipath.conf</a></p>
</li>
<li>
<p><a href="{URL_rhel_docs_legacy}html-single/dm_multipath/"><em>{enterprise-linux} DM Multipath</em></a></p>
</li>
<li>
<p><a href="{URL_virt_product_docs}{URL_format}administration_guide/index#Configuring_iSCSI_Multipathing">Configuring iSCSI Multipathing</a></p>
</li>
<li>
<p><a href="https://access.redhat.com/solutions/3234761">How do I customize /etc/multipath.conf on my RHVH hypervisors? What values must not change and why?</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ref-Recommended_Settings_for_Multipath_conf_{context}">Recommended Settings for Multipath.conf</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Do not override the following settings:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">user_friendly_names  no</dt>
<dd>
<p>Device names must be consistent across all hypervisors. For example, <code>/dev/mapper/{WWID}</code>. The default value of this setting, <code>no</code>, prevents the assignment of arbitrary and inconsistent device names such as <code>/dev/mapper/mpath{N}</code> on various hypervisors, which can lead to unpredictable system behavior.</p>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Do not change this setting to <code>user_friendly_names  yes</code>. User-friendly names are likely to cause unpredictable system behavior or failures, and are not supported.
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1"><code>find_multipaths	no</code></dt>
<dd>
<p>This setting controls whether {hypervisor-shortname} tries to access devices through multipath only if more than one path is available. The current value, <code>no</code>, allows {virt-product-shortname} to access devices through multipath even if only one path is available.</p>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Do not override this setting.
</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Avoid overriding the following settings unless required by the storage system vendor:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>no_path_retry	4</code></dt>
<dd>
<p>This setting controls the number of polling attempts to retry when no paths are available. Before {virt-product-shortname} version 4.2, the value of <code>no_path_retry</code> was <code>fail</code> because QEMU had trouble with the I/O queuing when no paths were available. The <code>fail</code> value made it fail quickly and paused the virtual machine. {virt-product-shortname} version 4.2 changed this value to <code>4</code> so when multipathd detects the last path has failed, it checks all of the paths four more times. Assuming the default 5-second polling interval, checking the paths takes 20 seconds. If no path is up, multipathd tells the kernel to stop queuing and fails all outstanding and future I/O until a path is restored. When a path is restored, the 20-second delay is reset for the next time all paths fail. For more details, see <a href="https://gerrit.ovirt.org/#/c/88082/">the commit that changed this setting</a>.</p>
</dd>
<dt class="hdlist1"><code>polling_interval	5</code></dt>
<dd>
<p>This setting determines the number of seconds between polling attempts to detect whether a path is open or has failed. Unless the vendor provides a clear reason for increasing the value, keep the VDSM-generated default so the system responds to path failures sooner.</p>
</dd>
</dl>
</div>
</div>
</div>



        </section>
      </section>
    </main>

    <script src="/ovirt-site/previews/2961/javascripts/lib/headings_anchors.js" type="text/javascript"></script><footer class='text-center' id='footer'><hr class='visible-print'><ul class='footer-nav-list'><li><a href='/ovirt-site/previews/2961/privacy-policy.html' target='_blank' title='Privacy policy'>Privacy policy</a></li><li><a href='/ovirt-site/previews/2961/community/about.html' target='_blank' title='About'>About</a></li><li><a href='/ovirt-site/previews/2961/general-disclaimer.html' target='_blank' title='Disclaimers'>Disclaimers</a></li></ul>&copy; 2013&ndash;2022 oVirt<div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/issues/new?labels=content&amp;title=Issue:%20/dropped/introduction_to_the_vm_portal/common/storage/assembly-Preparing_Storage_for_RHV.html&amp;template=' target='_blank' title='Report an issue'><i class="icon fab fa-github"></i>Report an issue with this page</a></div><div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/edit/master/source/dropped/introduction_to_the_vm_portal/common/storage/assembly-Preparing_Storage_for_RHV.adoc' target='_blank' title='Edit this page'><i class="icon fab fa-github"></i>Edit this page</a></div></footer></body>

</html>
